using System;
using System.Linq;
using System.Collections;

public class Kata
{
  public static string TicTacToeWinner(string board)
  {
    
    ArrayList theX = new ArrayList();
    ArrayList theO = new ArrayList();
    bool moreX = false;
    bool moreO = false;
    var theSpots = new[] {"1a", "1b", "1c", "pipe", "2a", "2b", "2c", "pipe2", "3a", "3b", "3c"};
    int i = 0;
    int j = 0;
    int k = 0;
    
    for(i = 0; i < board.Length; i++) {
      if(board[i] == 'x') { theX.Add(theSpots[i]); }
      if(board[i] == 'o') { theO.Add(theSpots[i]); }    
    }
    
    //String[] myArr = (String[]) myAL.ToArray( typeof( string ) );
    
    string[] xArray1 = (string[]) theX.ToArray( typeof( string ) );
    string[] oArray1 = (string[]) theO.ToArray( typeof( string ) );
    
    
    // Converting ArrayList to string array
    // Making a System.Collections.Generic.IEnumberable
    //string[] xArray1 = theX.ToArray(typeof(string)) as string[];
    //string[] oArray1 = theO.ToArray(typeof(string)) as string[];
    
    // var charArray = array.SelectMany(x => x.ToCharArray());
    // char[] C = string.Join(string.Empty, S).ToCharArray();
    
    // Explicit cast or conversion message
    //char[] xArray = xArray1.SelectMany(x => x.ToCharArray());
    //char[] oArray = oArray1.SelectMany(y => y.ToCharArray());
    
    // Took too long to complete
    //char[] xArray = string.Join(string.Empty, xArray1).ToCharArray();
    //char[] oArray = string.Join(string.Empty, oArray1).ToCharArray();  
    
    // Can't be used with the type arguments
    //IEnumerable<char> xArray = xArray1.SelectMany(x => x.ToCharArray());
    //IEnumerable<char> oArray = oArray1.SelectMany(x => x.ToCharArray());
    
    // explicit conversion or missing cast
    char[] xArray = xArray1.SelectMany(x => x.ToCharArray());
    char[] oArray = oArray1.SelectMany(x => x.ToCharArray());
    
    
   // SORTING CHARS IN ARRAY
   // best overload method has some invalid arguments
   // cannot convert `System.Collections.Generic.IEnumerable' expression to type `System.Array'
    Array.Sort(xArray);
    Array.Sort(oArray);
    
    for(j = 0; j < xArray.Length-2; j++) {
      if(xArray[j] == xArray[j+1] && xArray[j+1] == xArray[j+2]) { moreX = true; }
    }
    
    for(k = 0; k < oArray.Length-2; j++) {
      if(oArray[k] == oArray[k+1] && oArray[k+1] == oArray[k+2]) { moreO = true; }
    }
    
    if(moreX && moreO) { return "Game is a tie"; }
    if(moreX) { return "Player X is the winner"; }
    if(moreO) { return "Player O is the winner"; }
    else { return "Game is a tie"; }
    
  }
}